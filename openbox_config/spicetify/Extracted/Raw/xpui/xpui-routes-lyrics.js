"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[25],{45789:function(e,t,r){r.r(t),r.d(t,{LyricsContainer:function(){return q},default:function(){return J}});var n=r(27378),c=r.n(n),l=r(75260),s=r(85466),a=r(14298),i=r(45502),o="tWCG1__GYvwq6QmxJQsc",u="vSfoFiI4WuABjWl7cyd4",m="liLgW_Anyf1OrRpO1IID",d="_gtj_n_uxRq4P7iSQ_3c",v="VprGkpql5qCwYTRGvUnp",y="xUEC7JecXHxcmHdLLkY4",f="wR02E0JALxR4vJozjfJl",p="AIfgPe2VfPu6X3gcS5Iz",g="kbMExU5zc2on87qZEu5g",b="hr8GfMsh60PbgVDwa8lz",E="DGkVyx6TZiAUb8UsE5kv",O=r(64649),k=r(35181),h=r(90550);var x=r(26102),N=r(38655);function D(e,t){const[r,c]=(0,n.useState)(!1),[l,s]=(0,n.useState)(0),a=(0,n.useMemo)((()=>(0,x.N)({lyrics_format:t,track_uri:e})),[t,e]);return(0,n.useEffect)((()=>{c(!1),s(0)}),[a]),(0,n.useEffect)((()=>{if(!r&&l>140){(0,N.M)().send(a),c(!0)}}),[l,r,a]),s}var j=r(9807);function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){(0,O.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const P={start:0,end:1,text:""},S={"--line-count":3},U=c().memo((({lyrics:e=[],provider:t,trackUri:r})=>{const[l,s]=(0,n.useState)(0),a=D(r,"card");(e=>{const t=(0,n.useRef)();t.current=e,(0,n.useEffect)((()=>{const e=h.O.subscribe("position",(e=>{var r;null===(r=t.current)||void 0===r||r.call(t,e)}));return()=>{h.O.unsubscribe(e)}}),[t])})((e=>s(e)));const i=(0,n.useMemo)((()=>[P,P,...e].map(((e,t)=>w(w({},e),{},{lineNumber:t})))),[e]),o=i.findIndex((({start:e,end:t})=>l>=e&&l<t)),u=(0,n.useMemo)((()=>{const e=Math.max(o-1,0);return i.slice(e,e+3+2)}),[o,i]);return(0,n.useEffect)((()=>{a((e=>i.reduce(((e,{text:t,lineNumber:r})=>{const n=t.length>1?t.length:0;return e+=o===r?n:0}),e)))}),[i,o,a]),c().createElement("div",{className:y,style:S},c().createElement("div",{className:g},u.map((({text:e,lineNumber:t},r)=>{const n={"--animation-index":r};return c().createElement("p",{className:b,style:n,key:t,dir:"auto"},e)}))),t&&c().createElement(j.Dy,{as:"p",variant:j.Dy.mesto,className:p,dir:"auto"},k.ag.get("lyrics.providedBy",t)))}));var A=r(9957);const M=c().memo((({onObserve:e,text:t})=>{const{ref:r,inView:l}=(0,A.YD)({threshold:0});return(0,n.useEffect)((()=>{l&&e(t)}),[l,e,t]),c().createElement("p",{className:b,ref:r,dir:"auto","data-testid":"unsynced-lyric"},t)})),_=c().memo((({lyrics:e=[],provider:t,trackUri:r})=>{const l=D(r,"fullscreen"),s=(0,n.useCallback)((e=>{e.length>1&&l((t=>t+e.length))}),[l]);return c().createElement("div",{className:d},c().createElement(j.Dy.p,{variant:j.$e.ballad,className:v},k.ag.get("lyrics.unsynced")),c().createElement("div",null,e.map((({text:e},t)=>c().createElement(M,{key:r+t,onObserve:s,text:e})))),t&&c().createElement(j.Dy,{as:"p",variant:j.Dy.mesto,className:p,dir:"auto"},k.ag.get("lyrics.providedBy",t)))})),C=[k.ag.get("lyrics.noLyrics0"),k.ag.get("lyrics.noLyrics1"),k.ag.get("lyrics.noLyrics2"),k.ag.get("lyrics.noLyrics3")],I=c().memo((()=>{const e=C[Math.floor(Math.random()*C.length)];return c().createElement("div",{className:m},c().createElement("span",{className:E},e))}));var G=r(82907),R=r(67684),V=r(86268);const W=c().createElement("div",{className:u},c().createElement(i.H,null)),q=()=>{var e,t,r,n,i,u;const m=(0,l.v9)(G.Ci),d=(null==m?void 0:m.uri)||"",v=(null==m||null===(e=m.album)||void 0===e||null===(t=e.images)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.url)||"",{status:y,data:p}=(0,s.W)(d,v),g=(0,V.Y)((null==p?void 0:p.colors.dark)||null),[b]=(0,l.v9)(G.e5);(0,s.W)((null==b?void 0:b.uri)||"",(null==b||null===(n=b.album)||void 0===n||null===(i=n.images)||void 0===i||null===(u=i[0])||void 0===u?void 0:u.url)||"");let E=W;if(d)if(y===R.LyricsTrackStatus.UNAVAILABLE)E=c().createElement(I,null);else if(y===R.LyricsTrackStatus.LOADED&&p){const{lyrics:e,provider:t,isTimeSynced:r}=p;E=r?c().createElement(U,{trackUri:d,lyrics:e,provider:t}):c().createElement(_,{trackUri:d,lyrics:e,provider:t})}const O={"--lyrics-color-active":(null==p?void 0:p.colors.active)||a.ixZ,"--lyrics-color-inactive":(null==p?void 0:p.colors.bright)||a.Snx,"--lyrics-color-background":g};return c().createElement("div",{className:o,style:O},c().createElement("div",{className:f}),E)};var J=q}}]);
//# sourceMappingURL=xpui-routes-lyrics.js.map